## SOURCE
source ~/.mutt/vi-keys.rc
source ~/.mutt/mutt_colours
source ~/.mutt/aliases
# source ~/dotfiles/notmuch_mutt.rc

## USER DETAILS
set hidden_host
set realname = "David Kelly"
set from = "dkellino@gmail.com"
set use_from = yes
set envelope_from = "yes"
set shell = "/run/current-system/sw/bin/fish"
set sendmail="/run/current-system/sw/bin/msmtp"
set editor="nvim"
set forward_format="Fwd: %s"
set postpone=ask-yes

## DIRECTORY STRUCTURE
set folder="$HOME/.mutt/mail"
set mbox_type=Maildir
set spoolfile= "+inbox"
set mbox="+mbox"
set record= "+sent"
set postponed= "+[Gmail]/Drafts"
set nomove
set mailcap_path="~/.mutt/mailcap"
set mailcap_sanitize=yes

## PAGER
set pager=builtin
set pager_stop             # don't show the next msg after current
set pager_index_lines=10   # number of index lines to show
set pager_context=3        # number of context lines to show
set pager_stop             # don't go to next message automatically
set menu_scroll            # scroll in menus
set tilde                  # show tildes like in vim
unset markers 
set charset="UTF-8"

set sort_browser=alpha
set sort = reverse-date-received
set copy
set include

set edit_headers=yes

set alias_file = $HOME/.mutt/mail/mutt_aliases
set sort_alias=alias

set smart_wrap
set pager_context=5
set status_on_top


## -----------##
##  sidebar   ##
## -----------##

set sidebar_visible = yes
set sidebar_width = 30
set sidebar_short_path = no
set sidebar_delim_chars = '/.'
set sidebar_folder_indent = no
set sidebar_indent_string = '  '
set sidebar_new_mail_only = no
sidebar_whitelist '~/.mutt/mail'
set sidebar_next_new_wrap = no
set sidebar_divider_char = '|'
set sidebar_format = '%B%?F? [%F]?%* %?N?%N/?%S'
## Colour of the highlighted, but not open, mailbox.
color sidebar_highlight black color8
## Colour of the divider separating the Sidebar from Mutt panels
color sidebar_divider color8 black
## Colour to give mailboxes containing flagged mail
color sidebar_flagged red black
## Colour to give mailboxes containing new mail
color sidebar_new green black


## -----------##
## status bar ##
## -----------##

set status_format='-%r-Mutt: %f [Msgs:%?M?%M/?%m%?n? New:%n?%?o? Old:%o?%?d? Del:%d?%?F? Flag:%F?%?t? Tag:%t?%?p? Post:%p?%?b? Inc:%b?%?l? %l?]---(%s/%S)-%>-(%P)---'
 
 
## -------------##
## progress bar ##
## -------------##

color indicator cyan black

## From field gets 30% of remaining space, Subject gets 70%.
## Remaining space is the total width minus the other fields (35), minus the sidebar (24)
set my_index_format_pre='set my_col_from = `echo $((30 * ($(tput cols)-35-24) / 100))`; set my_col_subject = `echo $((70 * ($(tput cols)-35-24) / 100))`; set index_format="%2C | %Z [%d] %-$my_col_from.${my_col_from}'
set my_index_format_post=' (%-4.4c) %?M?<%M> ?%-$my_col_subject.${my_col_subject}s"'

folder-hook .*[sS]ent.* "$my_index_format_pre"t"$my_index_format_post"
folder-hook ! .*[sS]ent.* "$my_index_format_pre"F"$my_index_format_post"

auto_view text/html
alternative_order text/enriched text/plain text/html 

## macros
macro index \cB |w3m\n "call w3m to extract URLs out of a message"
macro pager \cB |w3m\n "call w3m to extract URLs out of a message"
set new_mail_command="notify-send 'ï‡™ New Email in %f' '%n new messages, %u unread.' &"
